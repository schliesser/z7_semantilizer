"use strict";function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,n){for(var t=0;t<n.length;t++){var i=n[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,n,t){return n&&_defineProperties(e.prototype,n),t&&_defineProperties(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}define(["TYPO3/CMS/Backend/Notification","TYPO3/CMS/Backend/ActionButton/ImmediateAction","TYPO3/CMS/Z7Semantilizer/Backend/Headline","TYPO3/CMS/Z7Semantilizer/Backend/Converter","TYPO3/CMS/Z7Semantilizer/Backend/Translate"],function(a,r,s,e,o){var i=function(){function t(e,n){_classCallCheck(this,t),this.headlines=n||[],this.key=e}return _createClass(t,[{key:"addHeadline",value:function(e){this.headlines.push(e)}},{key:"render",value:function(t){var i=this,e=this.headlines.filter(function(e){return e.isEditableType()&&e.issues.get(i.key).fix}).length,n=[];e&&n.push({label:o("notification.fix")+(1<e?" ("+e+")":""),action:new r(function(){i.headlines.forEach(function(e){return e.issues.fix(i.key)}),s.storeHeadlines(i.headlines,function(e,n){"function"==typeof t&&t(n),a.success(o("notification.fixed.title"),o("notification."+i.key+".title"),4)})})});e="mainHeadingNumber"===this.key?"info":"warning";a[e](o("notification."+this.key+".title"),o("notification."+this.key+".description"),10,n)}}]),t}(),t=function(){function t(e,n){_classCallCheck(this,t),this.key=e,null===this.get()&&this.set(n)}return _createClass(t,[{key:"get",value:function(){var e=localStorage.getItem(this.key);return null===e?null:parseInt(e)}},{key:"set",value:function(e){localStorage.setItem(this.key,e?"1":"0")}},{key:"enabled",value:function(){return 1===this.get()}},{key:"disabled",value:function(){return!this.enabled()}},{key:"enable",value:function(){this.set(1)}},{key:"disable",value:function(){this.set(0)}}]),t}();return function(){function n(e){return _classCallCheck(this,n),this.parent=e,this.autoload=new t("semantilizer-notification",!0),this}return _createClass(n,[{key:"showIssue",value:function(n){var t=this;this.parent.notifications.hideAll(),new i(n,this.parent.headlines.filter(function(e){return e.issues.has(n)})).render(function(e){return t.parent.revalidate(e)})}},{key:"showIssues",value:function(){var n=this,t={};this.parent.headlines.filter(function(e){return e.issues.count()}).forEach(function(n){return n.issues.each(function(e){t[e.key]=t[e.key]||[],t[e.key].push(n)})}),Object.keys(t).forEach(function(e){return new i(e,t[e]).render(function(e){return n.parent.revalidate(e)})})}},{key:"hideAll",value:function(){var n=a.messageContainer;(n=n&&void 0!==n[0]?n[0]:n)&&e.toArray(n.childNodes).forEach(function(e){return n.removeChild(e)})}}]),n}()});