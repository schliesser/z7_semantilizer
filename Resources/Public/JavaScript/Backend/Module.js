"use strict";function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}define(["TYPO3/CMS/Backend/Icons","TYPO3/CMS/Z7Semantilizer/Backend/Translate"],function(l,c){var u=function(){function t(e){return _classCallCheck(this,t),this.element=document.createElement(e||"div"),this}return _createClass(t,[{key:"setAttribute",value:function(e,t){return this.element.setAttribute(e,t),this}},{key:"setAttributes",value:function(t){var n=this;return Object.keys(t).forEach(function(e){return n.setAttribute(e,t[e])}),this}},{key:"setStyles",value:function(t){var n=this;return this.element&&t&&Object.keys(t).forEach(function(e){n.element.style[e]=t[e]}),this}},{key:"setClassName",value:function(e){return this.element.className=e,this}},{key:"setBemClassName",value:function(e,t,n){return this.setClassName((n||"semantilizer")+(e?"__"+e:"")+(t?"--"+t:""))}},{key:"setContent",value:function(e){return this.element.innerHTML=e,this}},{key:"appendTo",value:function(e){return e.appendChild(this.render())}},{key:"render",value:function(){return this.element}}]),t}();return function(){function n(e,t){_classCallCheck(this,n),_defineProperty(this,"element",void 0),_defineProperty(this,"parent",void 0),this.element=e,this.parent=t,this.init()}return _createClass(n,[{key:"clearContent",value:function(e){for(var t;t=(e||this.element).firstElementChild;)(e||this.element).removeChild(t)}},{key:"drawDescription",value:function(){this.parent.headlines.length&&new u("p").setContent(c("overview.description")).appendTo(this.element)}},{key:"drawList",value:function(){var e,r,o=this;this.parent.headlines.length?(e=new u("div").setBemClassName("listwrap").appendTo(this.element),r=new u("ul").setBemClassName("list").appendTo(e),this.parent.headlines.forEach(function(n){var i=new u("li").setBemClassName("item","level"+n.type).appendTo(r),e=new u("select").setBemClassName("select","level"+n.type).appendTo(i);if(n.isEditableType()){for(var t=1;t<=6;t++){var s=new u("option").setAttributes({value:t}).setContent("H"+t).appendTo(e);n.type===t&&(s.selected=!0)}e.addEventListener("change",function(e){n.type=e.target.options[e.target.selectedIndex].value,n.store(function(e){return!e.hasErrors&&o.parent.validate()})})}else new u("option").setContent("H"+n.type).appendTo(e),e.disabled="disabled";var a=n.issues.count();(n.isEditableRecord()?new u("a").setAttribute("href",n.getEditUrl()):new u("span")).setContent(n.text).setBemClassName("headline",a?"error":"").appendTo(i),a&&l.getIcon("actions-question-circle-alt",l.sizes.small).then(function(e){var t=new u("button").setAttributes({type:"button",title:c("overview.notification.show")}).setBemClassName("error-info").appendTo(i);t.insertAdjacentHTML("beforeend",e),t.addEventListener("click",n.showIssues)})}),this.wrap=e):new u("p").setContent(c("overview.empty")).appendTo(this.element)}},{key:"drawNotificationToggle",value:function(){var n=this,i=this.parent.notifications.autoload.enabled();l.getIcon(i?"actions-toggle-on":"actions-toggle-off",l.sizes.small).then(function(e){var t=new u("button").setAttribute("type","button").setContent(c(i?"overview.notifications.on":"overview.notifications.off")).setBemClassName("notifications-toggle").appendTo(n.element);t.insertAdjacentHTML("afterbegin",e+" "),t.addEventListener("click",function(){i?(n.parent.notifications.hideAll(),n.parent.notifications.autoload.disable()):(n.parent.notifications.showIssues(),n.parent.notifications.autoload.enable()),n.element.removeChild(t),n.drawNotificationToggle()})})}},{key:"lockStructure",value:function(){this.parent.notifications.hideAll();var e=new u("div").setBemClassName("lock").appendTo(this.wrap);new u("span").setBemClassName("lock-message").setContent(c("overview.update")).appendTo(e)}},{key:"drawStructure",value:function(){this.clearContent(),this.drawDescription(),this.drawList(),this.drawNotificationToggle()}},{key:"loader",value:function(){var t=this;l.getIcon("spinner-circle",l.sizes.small).then(function(e){t.element.insertAdjacentHTML("beforeend",e+'<span style="margin-left: 0.3em">'+c("overview.loading")+"</span>")})}},{key:"init",value:function(){this.clearContent()}}]),n}()});